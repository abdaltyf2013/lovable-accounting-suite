-- ============================================
-- سكريبت إضافة العملاء من المهمات
-- تم استخراج 26 عميل من قاعدة البيانات
-- ============================================

-- إضافة العملاء (سيتم تجاهل المكررات تلقائياً)
INSERT INTO public.clients (name, phone, notes)
VALUES
    ('ابوخالد', NULL, 'تم إضافة العميل من المهمات'),
    ('ابوراكان باص', '0536927702', 'تم إضافة العميل من المهمات'),
    ('احمد معوج', '0555701834', 'تم إضافة العميل من المهمات'),
    ('اخو حامد الحدي', NULL, 'تم إضافة العميل من المهمات'),
    ('اسكندر', '0555516898', 'تم إضافة العميل من المهمات'),
    ('العمدة', '0530139809', 'تم إضافة العميل من المهمات'),
    ('تجريبي', '0508400551', 'تم إضافة العميل من المهمات'),
    ('تجريبية', '0508400551', 'تم إضافة العميل من المهمات'),
    ('جمعان ابوخلف', '0509487199', 'تم إضافة العميل من المهمات'),
    ('خالد الحسن', NULL, 'تم إضافة العميل من المهمات'),
    ('خياط جارنا', '0576575817', 'تم إضافة العميل من المهمات'),
    ('سعيد الزهراني', '0500280958', 'تم إضافة العميل من المهمات'),
    ('عالي الفهمي', '0502854964', 'تم إضافة العميل من المهمات'),
    ('علي الشوحطي', '0577404949', 'تم إضافة العميل من المهمات'),
    ('علي العتيبي', '0540973455', 'تم إضافة العميل من المهمات'),
    ('غازي القاسمي', '0504516370⁩', 'تم إضافة العميل من المهمات'),
    ('فهد القاسمي', '0598947064', 'تم إضافة العميل من المهمات'),
    ('فهمي', '0532063245', 'تم إضافة العميل من المهمات'),
    ('مالك', '0538983229', 'تم إضافة العميل من المهمات'),
    ('محمد منير اسلام عامل ابويزيد', '0572864920', 'تم إضافة العميل من المهمات'),
    ('مروان معسلات', '0557324508', 'تم إضافة العميل من المهمات'),
    ('مستشار الجهوري', '0567746346', 'تم إضافة العميل من المهمات'),
    ('مصطفى مغسلة', '0505521931', 'تم إضافة العميل من المهمات'),
    ('منصور معدات', '0555574401', 'تم إضافة العميل من المهمات'),
    ('ناصر ابوخالد بن خالي', '0506275198', 'تم إضافة العميل من المهمات'),
    ('ناصر بن خالي', '0564662350', 'تم إضافة العميل من المهمات')
ON CONFLICT (name) DO NOTHING;

-- ربط المهمات بالعملاء
UPDATE public.tasks t
SET client_id = c.id
FROM public.clients c
WHERE t.client_name = c.name
AND t.client_id IS NULL;

-- عرض النتائج
SELECT 
    'تم إضافة العملاء بنجاح!' as message,
    (SELECT COUNT(*) FROM public.clients) as total_clients,
    (SELECT COUNT(*) FROM public.tasks WHERE client_id IS NOT NULL) as linked_tasks;
